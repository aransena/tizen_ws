<!DOCTYPE html>
<html>
	<head>
		<meta name="viewport" content="width=device-width, user-scalable=no">
		<title>Hello TAU</title>
		<link rel="stylesheet" href="lib/tau/wearable/theme/default/tau.css"/>
		<link rel="stylesheet" media="all" href="lib/tau/wearable/theme/default/tau.circle.min.css">
		<!--load theme file for your application-->
		<link rel="stylesheet"href="css/style.css"/>
	</head>
	<body>
	
	<div class="ui-page ui-page-active" id="setWSURL">
	   <div class="ui-content">
		<input type="text" id="ip_addr" size="11'>Enter Server IP<br>
	   </div>
   <footer class="ui-footer ui-bottom-button">
      <a href="" class="ui-btn" id="btn-setWS">Set</a>
   </footer>
	  
	<script>
      var ev = document.getElementById("btn-setWS");
      ev.addEventListener("click", function ()
      {
    	  var url = document.getElementById("ip_addr").value;
    	  var ws = "ws://"+url+":8888/ws";
    	  console.log("Websocket: "+ws);
    	  window.localStorage.setItem('url', ws.toString());
    	  console.log("saved: "+window.localStorage.getItem('url').toString());
    	  tau.changePage("settings.html");
      });
	    window.addEventListener( 'tizenhwkey', function( ev ) {
			if( ev.keyName === "back" ) {
				if(ws){
					ws.close();
				}
				document.removeEventListener("rotarydetent", rotaryEventHandler);	
				var page = document.getElementsByClassName( 'ui-page-active' )[0],
					pageid = page ? page.id : "";
				
				if( pageid === "pageMain" ) {
					try {
						tizen.application.getCurrentApplication().exit();
					} catch (ignore) {
						console.error("error exiting program");
					}
				} 
				else {
					window.history.back();
				}
			}
		} ); 
   </script>
   
	</div>
	
	</body>
</html>